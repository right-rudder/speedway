---
import { type CollectionEntry, getCollection } from "astro:content";
import BaseLayout from "../../layouts/BaseLayout.astro";
import HeaderSmall from "../../components/HeaderSmall.astro";
import CTAColor from "../../components/CTAColor.astro";
import TrainingRoadmap from "../../components/TrainingRoadmap.astro";
import CTAFlight from "../../data/CTAFlight.js";

import {
  COMPANY_NAME,
  SITE_DESCRIPTION,
  COMPANY_NAME_CAPS,
  COMPANY_NICKNAME,
  PHONE_NUMBER,
  ADDRESS_LINE_1,
  ADDRESS_LINE_2,
  EMAIL_ADDRESS,
} from "../../consts";

export async function getStaticPaths() {
  const locations = await getCollection("pilot-training");

  return locations.map((entry) => {
    const city = entry.data.city;
    const state = entry.data.stateShort;
    const customSlug = `${city}-${state}`.toLowerCase().replace(/\s+/g, "-");

    return {
      params: { slug: customSlug },
      props: entry, // still pass full entry data
    };
  });
}
type Props = CollectionEntry<"pilot-training">;
const location = Astro.props;
const locationCity = location.data.city || "your area";
const locationStateShort = location.data.stateShort || "your state";
const locationStateLong = location.data.stateLong || "your state";
const locationDescription =
  location.data.description ||
  "A great place with unique attractions and a welcoming community.";
const locationCounty =
  location.data.baseLocation ||
  "A well-known county with rich history and local charm.";
const locationKeyPlace1 =
  location.data.keyPlace1 || "A popular landmark worth visiting.";
const locationKeyPlace2 =
  location.data.keyPlace2 || "Another must-see location in the area.";

function randomItem(arr: string[]) {
  return arr[Math.floor(Math.random() * arr.length)];
}

const headerImage = randomItem(location.data.headerImages || []);
const rawHeadline = randomItem(location.data.headlines || []);
const headerH1 = rawHeadline
  .replace("{{city}}", locationCity)
  .replace("{{stateShort}}", locationStateShort)
  .replace("{{baseLocation}}", locationCounty);

const data = {
  data: {
    //SEO Header Stuff
    pageTitle: `${locationCity}, ${locationStateLong} Flight School for Pilot Training | ${COMPANY_NAME}`,
    pageDescription: `Explore the top flight school near you, we're based near ${locationCity}, ${locationStateShort}. ${SITE_DESCRIPTION}`,
    pageKeywords: `flight school ${locationCity} ${locationStateLong}, flight school ${locationCity} ${locationStateShort}, Private Pilot ${locationCity} ${locationStateLong}, Instrument Rating  ${locationCity} ${locationStateLong}, Commercial Pilot ${locationCity} ${locationStateLong}, Multi-Engine rating ${locationCity} ${locationStateLong}, Certified Flight Instructor ${locationCity} ${locationStateLong}, Sport Pilot ${locationCity} ${locationStateLong}, bachelor's in professional flight ${locationCity} ${locationStateLong}, bachelor's in aviation management ${locationCity} ${locationStateLong}, aircraft maintenance ${locationCity} ${locationStateLong}, discovery flight ${locationCity} ${locationStateLong}, intro flight ${locationCity} ${locationStateLong}, accelerated pilot training  ${locationCity} ${locationStateLong}, part time pilot training ${locationCity} ${locationStateLong}, ${COMPANY_NAME}, located at ${ADDRESS_LINE_1} ${ADDRESS_LINE_2}, ${PHONE_NUMBER}, ${COMPANY_NAME_CAPS}, ${COMPANY_NICKNAME}, ${EMAIL_ADDRESS}, how to become a pilot, flight school near, private pilot, discovery flight, introductory flight, instrument rating, commercial certificate, certified flight instructor, airline programs, how to become an airline pilot, flight school, pilot training, ${locationCity} flight school, personalized flight training, flexible flight programs, Private Pilot License training, Certified Flight Instructor (CFI) ${locationCity}, multi-engine training ${locationCity}, aviation school in ${locationStateLong}, Cessna 172 training, discovery flights ${locationCity}, pilot school near me, flight training with high pass rate, ${locationKeyPlace1}, ${locationKeyPlace2}, ${locationCounty}`,

    //top header
    header: {
      stars: true,
      imagePath:
        headerImage ||
        "/src/assets/speedway-checkered-flag-atlanta-hampton-georgia-plane-3.webp",
      imageAlt: `Flight school aircraft near ${locationCity}, ${locationStateShort}`,
      headerH1:
        headerH1 ||
        `Train to become a pilot near ${locationCity}, ${locationStateShort}`,
      paragraph: `${COMPANY_NAME} offers personalized pilot training near ${locationCity}, ${locationStateLong}. ${locationDescription}`,
      buttons: [
        {
          name: "Enroll Today",
          link: "/enroll-now",
          primary: false,
        },
        {
          name: "Discovery Flight",
          link: "/discovery-flight",
          primary: false,
        },
      ],
    },

    roadmap: {
      upperHeading: "Roadmap",
      heading: "Fast Track to the Flight Deck – Your Path to an Airline Career",
      descriptions: [
        `Achieve your dream of becoming an airline pilot with ${COMPANY_NAME}. Our Fast Track to the Flight Deck program provides an efficient and structured path from zero experience to a professional aviation career.`,
      ],
      steps: [
        {
          title: "Earn a Private Pilot License (PPL)",
          link: "/programs/private-pilot",
          paragraphs: [
            "The journey begins with earning your Private Pilot License (PPL). This certification introduces you to aviation fundamentals, including aircraft operations, flight navigation, and air traffic communication.",
            "At Speedway Flight Training, our PPL course is designed to give you hands-on flight experience with expert one-on-one instruction. This is your first major milestone toward becoming a professional pilot.",
          ],
          imagePath:
            "/src/assets/atlanta-airport-Speedway-Flight-Training-132.webp",
          imageAlt:
            "Speedway Flight Training student after their first solo flight",
        },
        {
          title: "Add an Instrument Rating (IR)",
          link: "/programs/instrument-rating",
          paragraphs: [
            "An Instrument Rating (IR) is your next step, allowing you to fly in various weather conditions and under Instrument Flight Rules (IFR). This is an essential qualification for any pilot pursuing a career in commercial aviation.",
            "Our IR program at Speedway focuses on precision, advanced navigation, and decision-making skills in IFR environments, preparing you for professional operations.",
          ],
          imagePath:
            "/src/assets/stock-kristina-delp-xx7EiLeralM-unsplash.webp",
          imageAlt: "Speedway student practicing IFR flight techniques",
        },
        {
          title: "Earn a Commercial Pilot License (CPL)",
          link: "/programs/commercial-pilot",
          paragraphs: [
            "With your PPL and IR completed, the next step is obtaining a Commercial Pilot License (CPL), which allows you to fly professionally and be compensated for your flights.",
            "At Speedway, our CPL training emphasizes advanced maneuvers, professionalism, and flight proficiency. This certification sets the foundation for commercial airline careers.",
          ],
          imagePath:
            "/src/assets/atlanta-airport-Speedway-Flight-Training-71.webp",
          imageAlt:
            "Speedway Flight Training student practicing commercial maneuvers",
        },
        {
          title: "Earn a Flight Instructor Certificate (CFI)",
          link: "/programs/certified-flight-instructor",
          paragraphs: [
            "Becoming a Certified Flight Instructor (CFI) is a strategic step for building flight hours efficiently while earning income. This role strengthens your aviation knowledge and instructional skills.",
            "At Speedway, we offer a structured CFI program that prepares you to train the next generation of pilots while working toward your ultimate career goals.",
          ],
          imagePath:
            "/src/assets/atlanta-airport-Speedway-Flight-Training-125.webp",
          imageAlt: "Speedway instructor and student in a pre-flight briefing",
        },
        {
          title: "Add a Certified Flight Instructor - Instrument (CFII)",
          link: "/programs/certified-flight-instructor",
          paragraphs: [
            "Enhancing your credentials with a Certified Flight Instructor - Instrument (CFII) rating allows you to train students in instrument flight procedures, further increasing your flight hours and expertise.",
            "At Speedway, our CFII program refines your instructional techniques and prepares you to mentor pilots through IFR training.",
          ],
          imagePath:
            "/src/assets/atlanta-airport-Speedway-Flight-Training-129.webp",
          imageAlt:
            "Speedway instructor reviewing instrument navigation techniques",
        },
        {
          title: "Optional: Add a Multi-Engine Rating (ME)",
          link: "/programs/multi-engine#top",
          paragraphs: [
            "Adding a Multi-Engine Rating (ME) enhances your capabilities and opens doors to airline, corporate, and charter operations. It's a valuable credential that demonstrates your ability to handle more complex aircraft.",
            "Speedway’s Multi-Engine Add-On program is designed to be completed in just 3–5 weeks and includes advanced maneuvers, emergency procedures, and full checkride preparation in a modern twin-engine aircraft.",
          ],
          imagePath: "/src/assets/stock-david-b-o27uCBOPbG0-unsplash.webp",
          imageAlt: "Speedway student pilot in a multi-engine aircraft",
        },
        {
          title: "Build Flight Hours & Gain Experience",
          paragraphs: [
            "After completing your instructor ratings (and optionally, your Multi-Engine Rating), the focus shifts to time-building. You’ll work toward meeting the 1,500-hour requirement for the Airline Transport Pilot (ATP) certificate.",
            "Speedway students often build hours as instructors or by flying in charter operations. Through our partnership with Indy Jet, eligible graduates can be referred to their charter operation — providing a direct path to commercial experience and turbine time.",
          ],
          imagePath:
            "/src/assets/atlanta-airport-Speedway-Flight-Training-38.webp",
          imageAlt: "Speedway graduate logging flight hours as a CFI",
        },
        {
          title: "Interview with Airlines & Begin ATP Training",
          paragraphs: [
            "When you reach 1,500 flight hours, you're eligible for the Airline Transport Pilot (ATP) certificate, the final requirement for becoming an airline pilot.",
            "Airline interviews assess your technical knowledge, decision-making skills, and readiness for commercial operations. Successful candidates receive conditional job offers and formal ATP training with their airline.",
          ],
          imagePath:
            "/src/assets/cessna-172-runway-takeoff-speedway-flight-training.webp",
          imageAlt: "Speedway graduate at an airline interview session",
        },
        {
          title: "Begin Your Airline Career",
          paragraphs: [
            "After meeting ATP requirements, you'll begin your career as a First Officer at a regional airline. This is your opportunity to gain real-world airline experience, preparing you for long-term success.",
            "With continuous training and experience, you can progress to Captain and eventually transition to major airlines, achieving your goal of flying for a commercial airline.",
          ],
          imagePath:
            "/src/assets/atlanta-airport-Speedway-Flight-Training-134.webp",
          imageAlt:
            "First Officer preparing for a flight in an airline cockpit",
        },
      ],
      finalParagraph:
        "Ready to take the first step toward becoming an airline pilot? Enroll in Speedway Flight Training’s Fast Track to the Flight Deck program and accelerate your journey to the skies.",
      finalButton: {
        name: "Apply Now",
        link: "/enroll",
        primary: true,
      },
    },
  },
};
---

<BaseLayout
  siteTitle={data.data.pageTitle}
  siteDescription={data.data.pageDescription}
  keywords={data.data.pageKeywords}
>
  <HeaderSmall content={data.data.header} />

  <TrainingRoadmap content={data.data.roadmap} />
  <CTAColor content={CTAFlight} />
</BaseLayout>
